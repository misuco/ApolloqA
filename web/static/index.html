<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>ApolloqA - Sound Co-Lab</title>
    <link rel="stylesheet" href="style.css">

    <!-- Babylon.js
    <script src="https://cdn.jsdelivr.net/npm/babylonjs@6.10.0/babylon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/babylonjs-loaders@6.10.0/babylonjs.loaders.min.js"></script>
    -->
</head>
<body style="background:black">

<div class="wrapper" style="width:100%;background:black">
    <section class="main-controls">
        <div id="menu_header">
            <output id="display_net_status">‚óê</output><output id="display_header" style="font-size: 1rem;">ApolloqA</output>
        </div>
        <div id="menu_buttons" class="buttons">
            <button id="menu_main" style="width:10%">|||</button>
            <button id="menu_session">Session</button>
            <button id="menu_mic">Mic</button>
            <button id="menu_gen_1">Gen1</button>
            <button id="menu_gen_2">Gen2</button>
            <button id="menu_gen_3">Gen3</button>
            <button id="menu_gen_4">Gen4</button>
            <button id="menu_pan_1">Pan1</button>
            <button id="menu_pan_2">Pan2</button>
            <button id="menu_pan_3">Pan3</button>
            <button id="menu_pan_4">Pan4</button>
        </div>
        <div id="config_session" hidden>
            <div class="flexbox">
                <select id="select_chords"></select>
                <select id="select_len"></select>
                <output id="display_bpm" style="font-size: 3rem;">140</output> BPM
            </div>
            <div class="flexbox">
                <button id="dec_bpm" class="narrow">-</button>
                <input id="range_bpm" type="range" min="40" max="240" value="140" step="1"></input>
                <button id="inc_bpm" class="narrow">+</button>
            </div>
        </div>

        <div id="config_mic" hidden>
            <canvas id="visualizer" style="display:block;height:100px"></canvas>
            <div class="buttons">
                <button id="record0">Rec 1</button>
                <button id="record1">Rec 2</button>
                <button id="record2">Rec 3</button>
                <button id="record3">Rec 4</button>
                <button id="stop">Stop</button>
            </div>
        </div>

        <div id="config_gen_0" hidden>
            1
            <select id="select_instrument_0"></select>
            <select id="select_quantize_0"></select>
            <select id="select_density_0"></select>
        </div>

        <div id="config_gen_1" hidden>
            2
            <select id="select_instrument_1"></select>
            <select id="select_quantize_1"></select>
            <select id="select_density_1"></select>
        </div>

        <div id="config_gen_2" hidden>
            3
            <select id="select_instrument_2"></select>
            <select id="select_quantize_2"></select>
            <select id="select_density_2"></select>
        </div>

        <div id="config_gen_3" hidden>
            4
            <select id="select_instrument_3"></select>
            <select id="select_quantize_3"></select>
            <select id="select_density_3"></select>
        </div>

        <div id="pan_1" hidden>
            PAN 1 <br/>
            <input id="radius_0" type="range" min="0" max="20" value="10" step="0.1"></input> radius
            <input id="yaw_0" type="range" min="0" max="360" value="90" step="1"></input> yaw
            <input id="pitch_0" type="range" min="0" max="360" value="90" step="1"></input> pitch
            <input id="rotate_yaw_0" type="range" min="0" max="100" value="0" step="1"></input> rotate yaw
            <input id="rotate_pitch_0" type="range" min="0" max="100" value="0" step="1"></input> rotate pitch
        </div>
        
        <div id="pan_2" hidden>
            PAN 2 <br/>
            <input id="radius_1" type="range" min="0" max="20" value="10" step="0.1"></input> radius
            <input id="yaw_1" type="range" min="0" max="360" value="90" step="1"></input> yaw
            <input id="pitch_1" type="range" min="0" max="360" value="90" step="1"></input> pitch
            <input id="rotate_yaw_1" type="range" min="0" max="100" value="0" step="1"></input> rotate yaw
            <input id="rotate_pitch_1" type="range" min="0" max="100" value="0" step="1"></input> rotate pitch
        </div>
        
        <div id="pan_3" hidden>
            PAN 3 <br/>
            <input id="radius_2" type="range" min="0" max="20" value="10" step="0.1"></input> radius
            <input id="yaw_2" type="range" min="0" max="360" value="90" step="1"></input> yaw
            <input id="pitch_2" type="range" min="0" max="360" value="90" step="1"></input> pitch
            <input id="rotate_yaw_2" type="range" min="0" max="100" value="0" step="1"></input> rotate yaw
            <input id="rotate_pitch_2" type="range" min="0" max="100" value="0" step="1"></input> rotate pitch
        </div>
        
        <div id="pan_4" hidden>
            PAN 4 <br/>
            <input id="radius_3" type="range" min="0" max="20" value="10" step="0.1"></input> radius
            <input id="yaw_3" type="range" min="0" max="360" value="90" step="1"></input> yaw
            <input id="pitch_3" type="range" min="0" max="360" value="90" step="1"></input> pitch
            <input id="rotate_yaw_3" type="range" min="0" max="100" value="0" step="1"></input> rotate yaw
            <input id="rotate_pitch_3" type="range" min="0" max="100" value="0" step="1"></input> rotate pitch
        </div>
        
        <div class="buttons">
            <button id="calc0">Calc 1</button>
            <button id="calc1">Calc 2</button>
            <button id="calc2">Calc 3</button>
            <button id="calc3">Calc 4</button>
            <button id="autoplay">Auto</button>
        </div>
        
        <div class="buttons">
            <button id="netSession0" hidden></button>
            <button id="netSession1" hidden></button>
            <button id="netSession2" hidden></button>
            <button id="netSession3" hidden></button>
            <button id="netSession4" hidden></button>
        </div>
        
    </section>
</div>
<canvas class="apolloqa"></canvas>

<script src="js/session.js"></script>

<script src="js/lib/babylon.js"></script>
<script src="js/lib/babylonjs.loaders.min.js"></script>
<script src="js/lib/babylon.gui.js"></script>
<script src="js/lib/HavokPhysics_umd.js"></script>
<script src="js/apolloqa.js"></script>
<script src="js/colors.js"></script>
<script src="js/camera.js"></script>
<script src="js/syncTrack.js"></script>
<script src="js/objects.js"></script>
<!--- <script src="js/gui.js"></script> --->
<script src="js/starfield.js"></script>
<script src="js/animation.js"></script>
<script src="js/multiuser-ws.js"></script>
<script src="js/audiorec.js"></script>
<script src="js/htmlGui.js"></script>
<script src="js/initScene.js"></script>

<script>



//const slalom1 = BABYLON.MeshBuilder.CreateSphere("slalom1", { diameter:8 }, scene);


/*
let star_mesh = null;

SceneLoader.ImportMeshAsync(
null,
// This link was copied from the Dropbox "Share" panel, but the domain needs to be changed to dl.dropboxusercontent.com to avoid issues with CORS
//"obj/12150_Christmas_Tree_V2_L2.obj",
//"obj/Spaceship_BarbaraTheBee.gltf",
//"obj/Flakes1_Classic.obj",
//"obj/Logo-A_002.obj",
"obj/estrellica.obj",
null,
scene
).then(({ meshes }) => {
// We now have our spaceship loaded into the scene!

// Set spaceshipMesh to the first mesh in the array: this is correct
// for our spaceship, but really depends on the mesh you loaded
console.log("Meshes : "+meshes);

star_mesh = meshes[0];

// To allow working with rotationQuaternion, which is
// null by default, we need to give it a value
star_mesh.rotationQuaternion = Quaternion.Identity();

star_mesh.position.x = 0;
star_mesh.position.y = 0;
star_mesh.position.z = -150;

star_mesh.scaling.x = 0.15;
star_mesh.scaling.y = 0.15;
star_mesh.scaling.z = 0.15;

star_mesh.rotation.x = 90;




});


var meshesToLoad = ["Flakes1_Classic.obj", "estrellica.obj"];

var toLoad = meshesToLoad.length;
var whenDoneFunction = function () {
toLoad--;

console.log("imported mesh, to load "+toLoad);
if (toLoad === 0) {
alert("loading done!");
}
}

for (var index = 0; index < meshesToLoad.length; index++) {
// The first parameter can be used to specify which mesh to import. Here we import all meshes
BABYLON.SceneLoader.ImportMesh("mesh"+index, "obj/", meshesToLoad[index], scene, function (newMeshes) {
// Set the target of the camera to the first imported mesh
whenDoneFunction();
//kek = scene.getMeshByName("test");
//kek.isVisible =true;
});
}

/*


const slalom1 = BABYLON.MeshBuilder.CreateSphere("slalom1", { diameter:8 }, scene);
const slalom2 = BABYLON.MeshBuilder.CreateSphere("slalom2", { diameter:8 }, scene);
const slalom3 = BABYLON.MeshBuilder.CreateSphere("slalom3", { diameter:8 }, scene);

slalom1.position.x = 0;
slalom1.position.y = 0;
slalom1.position.z = -80;

slalom2.position.x = 0;
slalom2.position.y = 0;
slalom2.position.z = -100;

slalom3.position.x = 0;
slalom3.position.y = 0;
slalom3.position.z = -150;


//// GROUND

//var ground = BABYLON.Mesh.CreatePlane("ground", 40000.0, scene);
//ground.material = new BABYLON.StandardMaterial("groundMat", scene);
//ground.material.diffuseColor = new BABYLON.Color3(1, 1, 1);
//ground.material.backFaceCulling = false;


//var url = "https://cdn.rawgit.com/BabylonJS/Extensions/master/DynamicTerrain/dist/babylon.dynamicTerrain.min.js";
/*
var url = "js/babylon.dynamicTerrain.min.js";
var terrainScript = document.createElement("script");
terrainScript.src = url;
document.head.appendChild(terrainScript);

var terrainMaterial = new BABYLON.StandardMaterial("materialGround", scene);
terrainMaterial.diffuseColor = new BABYLON.Color3(0.15, 0.9, 0.25);
//terrainMaterial.wireframe = true;

var terrainCreated = false;
var terrain;

terrainScript.onload = function() {
var mapSubX = 500;
var mapSubZ = 300;
var terrainSub = 100;

// map creation
var mapData = new Float32Array(mapSubX * mapSubZ * 3);
for (var l = 0; l < mapSubZ; l++) {
for (var w = 0; w < mapSubX; w++) {
mapData[3 *(l * mapSubX + w)] = (w - mapSubX * 0.5) * 2.0;
mapData[3 * (l * mapSubX + w) + 1] = w / (l +1) * Math.sin(l / 2) * Math.cos(w / 2) * 2.0;
mapData[3 * (l * mapSubX + w) + 2] = (l - mapSubZ * 0.5) * 2.0;
}
}

// terrain creation
var params = {
mapData: mapData,
mapSubX: mapSubX,
mapSubZ: mapSubZ,
terrainSub: terrainSub
};
terrain = new BABYLON.DynamicTerrain("terrain", params, scene);
terrain.mesh.material = terrainMaterial;
terrain.subToleranceX = 8;
terrain.subToleranceZ = 8;
terrain.LODLimits = [4, 3, 2, 1, 1];
terrainCreated = true;
};
*/

</script>
</body>
</html>
